{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "84b1ad28_202599e0",
        "filename": "stats/atoms.proto",
        "patchSetId": 2
      },
      "lineNbr": 12092,
      "author": {
        "id": 1022077
      },
      "writtenOn": "2021-03-02T23:22:54Z",
      "side": 1,
      "message": "I don\u0027t fully understand this. Could you explain what\u0027s the goal?",
      "range": {
        "startLine": 12091,
        "startChar": 0,
        "endLine": 12092,
        "endChar": 47
      },
      "revId": "d507b002f0e8e2302db972287034c3543290087b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "bb7e93bd_02183c86",
        "filename": "stats/atoms.proto",
        "patchSetId": 2
      },
      "lineNbr": 12092,
      "author": {
        "id": 1168158
      },
      "writtenOn": "2021-03-02T23:27:25Z",
      "side": 1,
      "message": "We run dex2oat on code path instead on a package name (https://source.corp.google.com/android/frameworks/base/services/core/java/com/android/server/pm/PackageDexOptimizer.java;l\u003d251). So the id is actually \u003cpackage name, version, code path\u003e, when we compare the time. However, in most of the time, a package should have 1 code path. I think only when the package has split APK, will it have multiple code paths.",
      "parentUuid": "84b1ad28_202599e0",
      "range": {
        "startLine": 12091,
        "startChar": 0,
        "endLine": 12092,
        "endChar": 47
      },
      "revId": "d507b002f0e8e2302db972287034c3543290087b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e6e6c1e6_ee4c6648",
        "filename": "stats/atoms.proto",
        "patchSetId": 2
      },
      "lineNbr": 12092,
      "author": {
        "id": 1022077
      },
      "writtenOn": "2021-03-02T23:47:09Z",
      "side": 1,
      "message": "Ok, so what you want here is simply the \"code_path\". But that\u0027s a very local concept and not really a file path. That code path is essentially the split_name for primary apks, or the secondary dex path. In the later case we should not care about the path. \n\nSo maybe go with \"apk_name\" and document that this signals whether not this is the base apk, a split, or a secondary dex files.",
      "parentUuid": "bb7e93bd_02183c86",
      "range": {
        "startLine": 12091,
        "startChar": 0,
        "endLine": 12092,
        "endChar": 47
      },
      "revId": "d507b002f0e8e2302db972287034c3543290087b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "ac480d63_b08eed78",
        "filename": "stats/atoms.proto",
        "patchSetId": 2
      },
      "lineNbr": 12092,
      "author": {
        "id": 1168158
      },
      "writtenOn": "2021-03-02T23:57:25Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "e6e6c1e6_ee4c6648",
      "range": {
        "startLine": 12091,
        "startChar": 0,
        "endLine": 12092,
        "endChar": 47
      },
      "revId": "d507b002f0e8e2302db972287034c3543290087b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "15c8d6bd_8fecd47e",
        "filename": "stats/atoms.proto",
        "patchSetId": 2
      },
      "lineNbr": 12092,
      "author": {
        "id": 1335232
      },
      "writtenOn": "2021-03-03T00:03:19Z",
      "side": 1,
      "message": "If this indicates whether it\u0027s a base apk, a split, or secondary dex file, would an enum work, or do we need the name since there might be more than one split or secondary dex file?\n\nThe metrics team prefers to avoid strings in atoms since they are harder to audit from a privacy and data size perspective. For example, that\u0027s why we store the uid instead of the package name.\n\nI\u0027m also getting a little concerned about adding extra fields here. The two we have so far are probably not a big deal, but the fact that we already have two makes me think we\u0027ll probably continue to add more.\n\nMaybe it makes sense to instead add a ArtDex2OatMetadataReported message that has the additional dex2oat metadata and a session_id that we can match against the atoms that we report.",
      "parentUuid": "ac480d63_b08eed78",
      "range": {
        "startLine": 12091,
        "startChar": 0,
        "endLine": 12092,
        "endChar": 47
      },
      "revId": "d507b002f0e8e2302db972287034c3543290087b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0d679f70_9bc3e0f5",
        "filename": "stats/atoms.proto",
        "patchSetId": 2
      },
      "lineNbr": 12092,
      "author": {
        "id": 1168158
      },
      "writtenOn": "2021-03-03T00:12:53Z",
      "side": 1,
      "message": "\u003e If this indicates whether it\u0027s a base apk, a split, or secondary dex file, would an enum work, or do we need the name since there might be more than one split or secondary dex file?\nHmm because the number of split apk is not necessary one so I don\u0027t think an enum will work well. Actually, we can go with base apk only. Hi Calin, does split apk or secondary dex file matter a lot?\n\n\u003e I\u0027m also getting a little concerned about adding extra fields here. The two we have so far are probably not a big deal, but the fact that we already have two makes me think we\u0027ll probably continue to add more.\nI don\u0027t think we will add more. But if yes later, I will create a new message.",
      "parentUuid": "15c8d6bd_8fecd47e",
      "range": {
        "startLine": 12091,
        "startChar": 0,
        "endLine": 12092,
        "endChar": 47
      },
      "revId": "d507b002f0e8e2302db972287034c3543290087b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3e64cadb_f09edb19",
        "filename": "stats/atoms.proto",
        "patchSetId": 2
      },
      "lineNbr": 12092,
      "author": {
        "id": 1022077
      },
      "writtenOn": "2021-03-03T00:31:46Z",
      "side": 1,
      "message": "The number is unbounded. Do we care about the actual naming? it would be nice to get it. The apk/split name is public information but i know the issues with adding string here... good catch Eric. So I guess enums could be a good approx.",
      "parentUuid": "0d679f70_9bc3e0f5",
      "range": {
        "startLine": 12091,
        "startChar": 0,
        "endLine": 12092,
        "endChar": 47
      },
      "revId": "d507b002f0e8e2302db972287034c3543290087b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "1d030709_1c1203aa",
        "filename": "stats/atoms.proto",
        "patchSetId": 2
      },
      "lineNbr": 12092,
      "author": {
        "id": 1168158
      },
      "writtenOn": "2021-03-03T05:04:16Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "3e64cadb_f09edb19",
      "range": {
        "startLine": 12091,
        "startChar": 0,
        "endLine": 12092,
        "endChar": 47
      },
      "revId": "d507b002f0e8e2302db972287034c3543290087b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}